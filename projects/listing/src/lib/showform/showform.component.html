<!--<mat-toolbar color="primary">
  <span class="fill-remaining-space">My Reactive Form with Material</span>
</mat-toolbar>-->





<section *ngIf="loading == true" class="example-section">
    <mat-progress-bar class="example-margin" [color]="color" [mode]="mode" [value]="value" [bufferValue]="bufferValue">
    </mat-progress-bar>
</section>
<div class="container" *ngIf="showform; else forminfo" novalidate>

    <form [formGroup]="formGroup" (ngSubmit)="onSubmit(formGroup.value)" class="form">

        <ng-container *ngIf="formdataval.fields!=null && formdataval.fields.length>0">
            <ng-container *ngFor="let fields of formdataval.fields ; let ival=index;">

                <div class="form_field_wrapper form_field_wrapper{{fields.name}}">
                    <mat-card class="form_header_{{fields.name}}"
                        *ngIf="fields.heading!=null && formGroup.controls[fields.name]!=null "
                        [innerHTML]="fields.heading">
                    </mat-card>
                    <mat-form-field *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='select'  )"
                        class="form-element form_field_{{fields.name}}">
                        <!-- for select-->
                        <!-- <div>ff</div> -->
                        <mat-label> Select {{fields.label}} </mat-label>
                        <mat-select (blur)="inputblur(fields.name)" (closed)="inputblur(fields.name)"
                            (selectionChange)="checkchange(fields,ival)" [formControlName]="fields.name"
                            [multiple]="fields.multiple?true:false">
                            <mat-option *ngFor="let data of fields.val" [value]="data.val"> {{data.name}}</mat-option>
                        </mat-select>
                        <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                        <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                        <ng-container
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                            <mat-error>
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </ng-container>

                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>


                    </mat-form-field>
                    <div *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='image'  )"
                        class="form-element form_field_{{fields.name}}">
                        <div>
                            <mat-label *ngIf="fields.multiple !=null && fields.multiple" [innerHTML]="fields.label">
                            </mat-label>
                        </div>

                        <div>
                            <ng-container *ngFor="let imgvals of fields.val">
                                <span class="imgwrapper imgwrap_{{fields.name}}_{{imgvals.key}}">
                                    <img (click)="chooseimg(imgvals,fields)" src="{{imgvals.image}}">
                                </span>
                            </ng-container>
                        </div>



                        <input (blur)="inputblur(fields.name)" type="hidden" placeholder="{{fields.label}}"
                            formControlName="{{fields.name}}">
                        <mat-error
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">
                            <ng-container *ngFor="let valdidations of fields.validations">
                                <span
                                    *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                            </ng-container>
                        </mat-error>
                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>

                    </div>

                    <div *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='checkbox' && fields.multiple==null )"
                        class="form-element form_field_{{fields.name}}">
                        <!-- <input   (blur)="inputblur(fields.name)" [type]="fields.type"  [formControlName]="fields.name">-->
                        <mat-label *ngIf="fields.multiple !=null && fields.multiple" [innerHTML]="fields.label">
                        </mat-label>
                        <mat-checkbox *ngIf="fields.multiple ==null && !fields.multiple" class=" example-margin"
                            (blur)="inputblur(fields.name)" (change)="checkchange(fields,ival)"
                            [formControlName]="fields.name" [labelPosition]="fields.labelPosition"> {{fields.label}}
                        </mat-checkbox>

                        <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                        <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                        <ng-container
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                            <mat-error>
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf=" formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </ng-container>

                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>

                    </div>
                    <div *ngIf="fields.name!=null && (fields.type=='checkbox' ) && fields.multiple !=null && fields.multiple==true "
                        class="form-element form_field_{{fields.name}}">
                        <!-- <input   (blur)="inputblur(fields.name)" [type]="fields.type"  [formControlName]="fields.name">-->
                        <mat-label *ngIf="fields.multiple !=null && fields.multiple" [innerHTML]="fields.label">
                        </mat-label>

                        <ng-container *ngIf="fields.multiple !=null && fields.multiple">
                            <ng-container *ngFor="let vals of fields.val , let vi=index;">
                                <mat-checkbox class="example-radio-button" (blur)="inputblur(fields.name)"
                                    (change)="checkchange(fields,ival)" formControlName="{{fields.name}}__{{vi}}"
                                    [value]="vals.key">{{vals.val}}
                                </mat-checkbox>

                            </ng-container>
                        </ng-container>

                        <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                        <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                        <!-- <ng-container *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                        <mat-error >
                            <ng-container *ngFor="let valdidations of fields.validations">
                                <span *ngIf="formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                            </ng-container>
                        </mat-error>

                    </ng-container>-->

                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>


                    </div>
                    <div *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='radio' )"
                        class="form-element form_field_{{fields.name}}">
                        <mat-label [innerHTML]="fields.label"></mat-label>

                        <mat-radio-group aria-labelledby="example-radio-group-label"
                            class="example-radio-group form_field_{{fields.name}}" [formControlName]="fields.name">
                            <mat-radio-button class=" example-radio-button" (blur)="inputblur(fields.name)"
                                (change)="checkchange(fields,ival)" *ngFor="let vals of fields.val" [value]="vals.key">
                                {{vals.val}}
                            </mat-radio-button>
                        </mat-radio-group>

                        <!--<ng-container *ngFor="let vals of fields.val">
             <mat-checkbox class="form_field_{{fields.name}} example-radio-button" (blur)="inputblur(fields.name)"   [formControlName]="fields.name" [value]="vals.key">{{vals.val}}</mat-checkbox>

         </ng-container>-->


                        <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                        <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                        <ng-container
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                            <mat-error>
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf=" formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </ng-container>

                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>


                    </div>

                    <div>
                        <mat-form-field
                            *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='email' || fields.type=='number' || fields.type=='text' || fields.type == 'password')"
                            class="form-element form_field_{{fields.name}}">
                            <mat-label [innerHTML]="fields.label"></mat-label>

                            <input matInput (blur)="inputblur(fields.name)" [type]="fields.type"
                                [placeholder]="fields.label" (change)="checkchange(fields,ival)"
                                [formControlName]="fields.name">

                            <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                            <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                            <ng-container
                                *ngIf="formGroup.controls[fields.name] !=null && !formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                                <mat-error>
                                    <ng-container *ngFor="let valdidations of fields.validations">
                                        <span
                                            *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                    </ng-container>
                                </mat-error>
                            </ng-container>

                            <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                                <mat-hint align="start">{{fields.hint}}</mat-hint>
                            </ng-container>

                        </mat-form-field>


                        <div class="passbuttoncls" *ngIf="formGroup.controls[fields.name] != null && (fields.type == 'password'||fields.type == 'text' ) && 
                        fields.passwordflag == true ">
                            <button mat-raised-button color="accent" type="button" (click)="GeneratePassword(fields)"
                                class="GeneratePasswordcls">
                                Generate Password</button> &nbsp;

                            <button mat-raised-button color="accent" type="button"
                                (click)="copyGeneratePassword(fields)" class="GeneratePasswordcls">
                                Copy Password</button> &nbsp;

                            <span *ngIf="isPasswordVisible == true" class="material-icons"
                                (click)="previewGeneratePassword(fields)" style="cursor: pointer;">
                                remove_red_eye
                            </span>

                            <span *ngIf="isPasswordVisible == false" class="material-icons"
                                (click)="previewGeneratePassword(fields)" style="cursor: pointer;">
                                visibility_off
                            </span>
                        </div>

                        <div class="passbuttoncls"
                            *ngIf="formGroup.controls[fields.name] != null && customlistenbuttons?.flag == true">


                            <div *ngFor="let item of customlistenbuttons.buttons">

                                <div *ngIf="fields.type == item.type && fields?.custombuttonflag == true">
                                    <span>
                                        <button mat-raised-button color="accent" type="button"
                                            (click)="CustomFlagFields(fields,item)" class="CustomFlagFieldscls">
                                            {{item?.labeladd}}<span class="material-icons">
                                                add
                                            </span></button> &nbsp;

                                        <button mat-raised-button color="accent" type="button"
                                            (click)="CustomFlagFieldsRemove(fields,item)" class="CustomFlagFieldscls">
                                            {{item?.labelremove}}<span class="material-icons">
                                                remove
                                            </span></button>
                                    </span>
                                </div>
                            </div>

                        </div>

                        <div *ngIf=" fields?.customheadingflag != null &&  fields?.customheadingflag == true">
                            <div *ngIf="fields?.customheadingtitle != null">
                                <mat-card class="customheadingtitlecls">
                                    {{fields?.customheadingtitle}}</mat-card>
                            </div>
                        </div>

                    </div>

                    <mat-form-field *ngIf="formGroup.controls[fields.name]!=null && fields.type=='textarea' "
                        class="form-element form_field_{{fields.name}}">
                        <mat-label [innerHTML]="fields.label"></mat-label>
                        <textarea matInput placeholder="Comment" (blur)="inputblur(fields.name)"
                            [rows]="fields.rows?fields.rows:6" [cols]="fields.cols?fields.cols:50"
                            [formControlName]="fields.name" (change)="inputblur(fields.name)">
                        </textarea>
                        <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                        <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                        <ng-container
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                            <mat-error>
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </ng-container>

                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>
                    </mat-form-field>


                    <mat-form-field *ngIf="formGroup.controls[fields.name]!=null && fields.type=='date' "
                        class="form-element form_field_{{fields.name}}">
                        <mat-label [innerHTML]="fields.label"></mat-label>

                        <input matInput [matDatepicker]="picker1" [formControlName]="fields.name" [min]="fields.minDate"
                            [max]="fields.maxDate" (focus)="picker1.open()">
                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                        <mat-datepicker #picker1></mat-datepicker>
                        <!-- <textarea matInput 
     placeholder="Comment" 
     [formControlName]="fields.name" 
     (change)="inputblur(fields.name)">
  </textarea> -->
                        <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                        <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                        <ng-container
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                            <mat-error>
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </ng-container>

                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>


                    </mat-form-field>
                    <mat-form-field *ngIf="formGroup.controls[fields.name]!=null && fields.type=='autocomplete' "
                        class="form-element form_field_{{fields.name}}">
                        <mat-label [innerHTML]="fields.label"></mat-label>
                        <!-- {{fields.val.length}}
 -->



                        <!-- mat-input-element mat-form-field-autofill-control cdk-text-field-autofill-monitored ng-untouched ng-dirty ng-valid -->
                        <!-- mat-input-element mat-form-field-autofill-control cdk-text-field-autofill-monitored ng-untouched ng-dirty ng-invalid -->

                        <input matInput (blur)="inputblur(fields.name)" (click)="reloadautocomplete(fields)"
                            (keyup)=filterautocomplete(fields.name,fields) [formControlName]="fields.name"
                            placeholder="{{fields.label}}" [matAutocomplete]="auto">

                        <!-- <mat-autocomplete #auto="matAutocomplete" *ngIf="currentautocomplete==fields.name || currentautocomplete=='' "> -->
                        <mat-autocomplete #auto="matAutocomplete">
                            <ng-container *ngIf="filerfielddata!=null && filerfielddata.length>0 ">
                                <mat-option *ngFor="let vals of filerfielddata " [value]="vals.key"
                                    (click)="setautocompletevalue(vals,fields)">
                                    <!-- <img class="example-option-img" aria-hidden [src]="state.flag" height="25"> -->
                                    <span>{{vals.val}}</span>
                                    <!-- <small>Population: {{state.population}}</small> -->
                                </mat-option>
                            </ng-container>
                        </mat-autocomplete>





                        <mat-chip-list *ngIf="autocompletefiledvalue[fields.name] !=null && fields.multiple==null"
                            aria-label="{{fields.name}} data">
                            <ng-container *ngFor="let vals of fields.val ">
                                <ng-container *ngIf="vals.key==autocompletefiledvalue[fields.name]">
                                    <mat-chip [removable]=true>{{vals.val}}
                                        <mat-icon matChipRemove (click)="removechipsingle(fields)">cancel</mat-icon>
                                    </mat-chip>
                                </ng-container>

                            </ng-container>

                        </mat-chip-list>


                        <mat-chip-list *ngIf="autocompletefiledvalue[fields.name] !=null && fields.multiple!=null"
                            aria-label="{{fields.name}} data">
                            <ng-container *ngFor="let vals of fields.val ">
                                <ng-container *ngFor="let avals of autocompletefiledvalue[fields.name] ; let ib=index ">
                                    <ng-container *ngIf="vals.key==avals">
                                        <mat-chip [removable]=true>{{vals.val}}
                                            <mat-icon matChipRemove (click)="removechipmultiple(fields,ib)">cancel
                                            </mat-icon>
                                        </mat-chip>
                                    </ng-container>
                                </ng-container>

                            </ng-container>

                        </mat-chip-list>

                        <!-- <textarea matInput 
     placeholder="Comment" 
     [formControlName]="fields.name" 
     (change)="inputblur(fields.name)">
  </textarea> -->
                        <span *ngIf="fields.prefix!=null" matPrefix> {{fields.prefix}} &nbsp;</span>
                        <span *ngIf="fields.suffix!=null" matSuffix>{{fields.suffix}}</span>

                        <ng-container
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">

                            <mat-error>
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </ng-container>

                        <ng-container *ngIf="  fields.hint!=null && formGroup.controls[fields.name]!=null  ">
                            <mat-hint align="start">{{fields.hint}}</mat-hint>
                        </ng-container>


                    </mat-form-field>

                    <!-- [config]="{uiColor: '#99000'}" 

[readonly]="false"
                (change)="onChange($event)"
                (editorChange)="onEditorChange($event)" 
                (ready)="onReady($event)"
                (focus)="onFocus($event)"
                (blur)="onBlur($event)"
                (contentDom)="onContentDom($event)"
                (fileUploadRequest)="onFileUploadRequest($event)"
                (fileUploadResponse)="onFileUploadResponse($event)"
                (paste)="onPaste($event)"
                (drop)="onDrop($event)"
                debounce="500"

                 [ngModelOptions]="{standalone: true}


                   <ckeditor
                [(ngModel)]="ckeditorContent"
                [ngModelOptions]="{standalone: true}"
                
                
                >
              </ckeditor>
-->



                    <div *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='editor' )"
                        class="form-element form_field_{{fields.name}}">
                        <!-- <input  (blur)="inputblur(fields.name)" type="{{fields.type}}" placeholder="{{fields.label}}" formControlName="{{fields.name}}"> -->

                        <div *ngIf="fields.ckeConfig != null && fields.ckeConfig != ''">
                            <mat-label [innerHTML]="fields.label"></mat-label>
                            <ckeditor (blur)="inputblur(fields.name)" [config]="fields.ckeConfig"
                                [formControlName]="fields.name"></ckeditor>
                            <mat-error
                                *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </div>

                        <div *ngIf="fields.ckeConfig == null || fields.ckeConfig == ''">
                            <mat-label [innerHTML]="fields.label"></mat-label>
                            <ckeditor (blur)="inputblur(fields.name)" [formControlName]="fields.name"></ckeditor>
                            <mat-error
                                *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">
                                <ng-container *ngFor="let valdidations of fields.validations">
                                    <span
                                        *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                                </ng-container>
                            </mat-error>
                        </div>



                    </div>



                    <div *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='externaldata' )"
                        class="form-element form_field_{{fields.name}}">

                        <span class="externalDataFunctioncls">
                            <button type="button" mat-raised-button color="primary"
                                (click)="externalDataFunction(fields,ival)">{{fields.label}}</button>
                        </span>
                        <br>

                        <ng-container *ngIf="fields.value != null && fields.value.length >0">
                            <!-- {{fields.value | json}} -->

                            <div *ngFor="let item of fields.value;let i = index">
                                <div class="externalcardcls">
                                    <mat-card>

                                        <span class="keycls">
                                            {{item.label}} :
                                        </span>

                                        <span class="valcls" *ngIf="item.imgflag == null">
                                            {{item.val}}
                                        </span>

                                        <span class="imgcls" *ngIf="item.imgflag != null && item.imgflag == true">
                                            <img [src]="item.val">
                                        </span>

                                        <span class="external_buttoncls">


                                            <span style="cursor: pointer;"
                                                (click)="externalDataEditFunction('edit',fields,ival,i)"
                                                class="material-icons">
                                                create
                                            </span>

                                            <span style="cursor: pointer;"
                                                (click)="externalDataEditFunction('remove',fields,ival,i)"
                                                class="material-icons">
                                                clear
                                            </span>

                                        </span>

                                    </mat-card>
                                </div>
                            </div>

                        </ng-container>
                        <!-- <ng-container *ngIf="externalDataVal != null && externalDataVal.length >0">

                            <ng-container *ngFor="let item of externalDataVal">
                                <div *ngIf="fields.name == item.name && item.value != null && item.value.length >0">

                                    {{item | json}}

                                    {{fields.value | json}}

                                </div>
                            </ng-container>

                        </ng-container> -->

                    </div>

                    <div *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='hidden' )"
                        class="form-element form_field_{{fields.name}}">
                        <input (blur)="inputblur(fields.name)" type="{{fields.type}}" placeholder="{{fields.label}}"
                            formControlName="{{fields.name}}">
                        <mat-error
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">
                            <ng-container *ngFor="let valdidations of fields.validations">
                                <span
                                    *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                            </ng-container>
                        </mat-error>
                    </div>

                    <div *ngIf="formGroup.controls[fields.name]!=null && (fields.type=='file' )"
                        class="form-element form_field_{{fields.name}}">
                        <mat-label [innerHTML]="fields.label"></mat-label>
                        <div class="aligner" (load)="triggerevents(fields)">
                            <div class="drop" (change)="fileChangeEvent($event)" [attr.fileid]="fields.name"
                                id="drop{{fields.name}}" (click)="onchoosefiles($event,fields.name,fields.multiple)">Click or Drop files here .
                                <!-- Or <br><input type="file" (change)="fileChangeEvent($event)" /> -->

                                <ng-container *ngIf="fields.multiple !=null && fields.multiple==true">
                                 <input type="file" multiple id="filechoosermultiple{{fields.name}}" style="display:none"  (change)="handleDrop($event)">
                                </ng-container>

                                <ng-container *ngIf="fields.multiple == null ">
                                 <input type="file" id="filechoosersingle{{fields.name}}" style="display:none" multiple  (change)="handleDrop($event)">
                                </ng-container>
                            </div>

                            <!-- <input type="file" (change)="fileChangeEvent($event)" /> -->

                            <!-- <span>{{fields | json}}</span> -->

                            <div class="filesid" id="list{{fields.name}}">
                                <h1 *ngIf="filearray[fields.name]!=null ">Files:</h1>
                                <!-- <div></div> -->
                                <ng-container
                                    *ngIf="filearray[fields.name] !=null  && fields.multiple==null && fields.loadfile != null && fields.loadfile == 1">
                                    <div class="filecontainerdiv">
                                        <span *ngIf="filearray[fields.name].uploaded==1"
                                            class="material-icons fileuploadcompleteicon ">
                                            cloud_done
                                        </span>


                                        <div class="imagedivcls"
                                            *ngIf="filearray[fields.name].type == 'image/jpeg' || filearray[fields.name].type == 'image/png' || filearray[fields.name].type == 'image/jpg'">

                                            <div class="divimagecardcls">
                                                <mat-card class="example-card imagecardcls"
                                                    *ngIf="fields.imageUrl != null && fields.imageUrl != ''">
                                                    <img mat-card-image [src]="fields.imageUrl">
                                                </mat-card>
                                            </div>


                                            <div class="divimagecardcls"
                                                *ngIf="fields.value != null && fields.value != '' && fields.value.fileservername != null">

                                                <mat-card class="example-card imagecardcls">

                                                    <span class="material-icons cropcls"
                                                        *ngIf="fields.aspectratio != null && fields.aspectratio != '' && fields.aspectratio.length > 0"
                                                        (click)="opensingleimagecrop(fields)">
                                                        crop
                                                    </span>

                                                    <img mat-card-image
                                                        src="https://{{fields.value.bucket}}.s3.amazonaws.com/{{fields.value.path}}{{fields.value.fileservername}}">
                                                </mat-card>
                                            </div>


                                            <div class="cropimagesdiv"
                                                *ngIf="fields.aspectratio != null && fields.aspectratio != '' && fields.aspectratio.length > 0 && fields.imageUrl != null && fields.imageUrl != ''">
                                                <h2> Croped Images :</h2>

                                                <ng-container *ngFor="let c of fields.aspectratio;let ci=index"
                                                    class="image-cropper-cls">
                                                    <br />
                                                    <span>Croped Image (Asepect Ratio) :
                                                        {{fields.imagecroppedratiolabel[ci]}} </span><br>

                                                    <image-cropper [imageBase64]="fields.imageUrl"
                                                        [maintainAspectRatio]="true" [aspectRatio]="c"
                                                        (imageCropped)="singleimageCropped($event,fields,ival,ci)"
                                                        (imageLoaded)="imageLoaded()" (cropperReady)="cropperReady()"
                                                        (loadImageFailed)="loadImageFailed()" [imageQuality]="100"
                                                        [resizeToHeight]="300"></image-cropper>

                                                </ng-container>
                                            </div>
                                        </div>
                                        <div class="filesdivcls">
                                            <span class="material-icons"
                                                *ngIf="filearray[fields.name].type == 'application/pdf'">
                                                picture_as_pdf
                                            </span>

                                            <span class="material-icons"
                                                *ngIf="filearray[fields.name].type == 'video/mp4'">
                                                movie_filter
                                            </span>

                                            <span class="material-icons"
                                                *ngIf="filearray[fields.name].type == 'text/csv' || filearray[fields.name].type == 'text/plain'">
                                                description
                                            </span>

                                            <span
                                                class="uploadedfilename uploadedfilename_{{filearray[fields.name]}}">{{filearray[fields.name].name}}</span>
                                            <br />
                                            <span
                                                class="uploadedfiletype uploadedfiletype_{{filearray[fields.name]}}">{{filearray[fields.name].type}}</span>
                                        </div>


                                        <div class="filefieldsmaincls">
                                            <ng-container class="descdiv"
                                                *ngIf=" filearray[fields.name] !=null && fields.imagefields != null && fields.imagefields != '' && fields.imagefields.length > 0 ">
                                                <div class="filefieldscls">
                                                    <div class="filefields"
                                                        *ngFor="let item of fields.imagefields;let i =index;trackBy: trackByFn">

                                                        <mat-form-field class="example-full-width"
                                                            *ngIf="item.type == 'text'">
                                                            <input matInput type="text"
                                                                [(ngModel)]="fields.imagefields[i].value"
                                                                [ngModelOptions]="{standalone: true}"
                                                                name="{{item.name}}" matInput
                                                                placeholder="{{item.label}}">
                                                        </mat-form-field>

                                                        <mat-form-field class="example-full-width"
                                                            *ngIf="item.type == 'textarea'">
                                                            <textarea matInput name="{{item.name}}"
                                                                [(ngModel)]="fields.imagefields[i].value"
                                                                [ngModelOptions]="{standalone: true}"
                                                                placeholder="{{item.label}}" [rows]='3'
                                                                [cols]='30'></textarea>
                                                        </mat-form-field>

                                                        <mat-form-field class="example-full-width"
                                                            *ngIf="item.type == 'number'">
                                                            <input type="number" matInput name="{{item.name}}"
                                                                [ngModelOptions]="{standalone: true}"
                                                                [(ngModel)]="fields.imagefields[i].value" matInput
                                                                placeholder="{{item.label}}">
                                                        </mat-form-field>

                                                        <div *ngIf="item.type == 'checkbox'">
                                                            <mat-checkbox name="{{item.name}}"
                                                                [(ngModel)]="fields.imagefields[i].value"
                                                                [ngModelOptions]="{standalone: true}" matInput>
                                                            </mat-checkbox>
                                                            &nbsp; {{item.label}}
                                                        </div>
                                                    </div>

                                                </div>
                                            </ng-container>
                                        </div>



                                        <div class="actionbtndiv">
                                            <mat-chip class="fileuploadbutton" style="cursor: pointer;"
                                                *ngIf="filearray[fields.name].uploaded==null " mat-raised-button
                                                (click)="uploadfile(fields)">Upload</mat-chip>

                                            <mat-chip class="deletesinglefilecls" style="cursor: pointer;"
                                                *ngIf="fields.loaded != null && fields.loaded==0" mat-raised-button
                                                (click)="deletesinglefile(fields,filearray[fields.name].type)">Delete
                                            </mat-chip>

                                            <mat-chip class="filedeletebutton" style="cursor: pointer;"
                                                *ngIf="filearray[fields.name].uploaded != null && filearray[fields.name].uploaded==1"
                                                mat-raised-button (click)="deletefile(fields)">Delete</mat-chip>
                                        </div>

                                        <!-- <mat-chip>Papadum</mat-chip> -->

                                        <section *ngIf="filearray[fields.name].uploaded==2 "
                                            class="example-section uploadprogress">
                                            <mat-progress-bar class="example-margin" [color]="color" [mode]="mode"
                                                [value]="value" [bufferValue]="bufferValue">
                                            </mat-progress-bar>
                                        </section>
                                    </div>
                                </ng-container>


                                <!-- for multiple file uploads  -->
                                <ng-container
                                    *ngIf="filearray[fields.name]!=null && fields.multiple !=null  && fields.multiple==true">
                                    <ng-container
                                        *ngFor="let files of filearray[fields.name]; let fi=index;trackBy: trackByFnMulti">
                                        <div class="filecontainerdiv">

                                            <!-- {{files | json}} ++ -->

                                            <div *ngIf="files.loadfile != null && files.loadfile==1"
                                                class="filesdivcls">

                                                <!-- {{files.loadfile}}+++++++++++== -->

                                                <span *ngIf="files.uploaded==1"
                                                    class="material-icons fileuploadcompleteicon">
                                                    cloud_done
                                                </span>

                                                <div class="divimagecardcls"
                                                    *ngIf="files.type == 'image/jpeg' || files.type == 'image/png' || files.type == 'image/jpg'">


                                                    <mat-card class="example-card imagecardcls"
                                                        *ngIf="files.imageUrl != null && files.imageUrl != ''">
                                                        <img mat-card-image [src]="files.imageUrl">
                                                    </mat-card>

                                                    <mat-card class="example-card imagecardcls"
                                                        *ngIf="files.imageUrl == null">

                                                        <span class="material-icons cropcls"
                                                            *ngIf="files.aspectratio != null && files.aspectratio != '' && files.aspectratio.length > 0"
                                                            (click)="opensingleimagecropformultiple(files)">
                                                            crop
                                                        </span>


                                                        <img mat-card-image
                                                            src="https://{{files.bucket}}.s3.amazonaws.com/{{files.path}}{{files.fileservername}}">
                                                    </mat-card>

                                                    <div class="cropimagesdiv"
                                                        *ngIf="files.aspectratio != null && files.aspectratio != '' && files.aspectratio.length > 0 && files.imageUrl != null && files.imageUrl != ''">
                                                        <h2> Croped Images :</h2>

                                                        <ng-container *ngFor="let c of files.aspectratio;let ci=index">
                                                            <br />
                                                            <span>Croped Image (Asepect Ratio) :
                                                                {{files.imagecroppedratiolabel[ci]}} </span><br>

                                                            <image-cropper [imageBase64]="files.imageUrl"
                                                                [maintainAspectRatio]="true" [aspectRatio]="c"
                                                                [resizeToWidth]="128"
                                                                (imageCropped)="multipleimageCropped($event,files,ival,ci,fi,filearray[fields.name])"
                                                                (imageLoaded)="imageLoaded()"
                                                                (cropperReady)="cropperReady()"
                                                                (loadImageFailed)="loadImageFailed()"
                                                                [imageQuality]="100" [resizeToHeight]="300">
                                                            </image-cropper>

                                                            <!-- <mat-card class="example-card imagecardcls"
                                                                *ngIf="files.croppedImage[ci] != null">
                                                                <span>Croped Image Output : </span><br>
                                                                <img class="croppedImagecls"
                                                                    [src]="files.croppedImage[ci]" />
                                                            </mat-card> -->

                                                        </ng-container>
                                                    </div>


                                                </div>

                                                <span class="material-icons" *ngIf="files.type == 'application/pdf'">
                                                    picture_as_pdf
                                                </span>

                                                <span class="material-icons" *ngIf="files.type == 'video/mp4'">
                                                    movie_filter
                                                </span>

                                                <span class="material-icons"
                                                    *ngIf="files.type == 'text/csv' || files.type == 'text/plain'">
                                                    description
                                                </span>

                                                <div class="filenamecls">
                                                    <span class="fileuploadednameclass"> {{files.name}}</span>
                                                    <br />
                                                    <span class="fileuploadedtypeclass"> {{files.type}}</span>
                                                </div>


                                                <br>
                                                <!-- files ++++ 22 => {{files.imagefields | json}}    -->
                                                <!-- multipleImgFormData -->
                                                <div class="filefieldsmaincls">
                                                    <ng-container class="descdiv"
                                                        *ngIf="fields.imagefields != null && fields.imagefields != '' && fields.imagefields.length > 0">

                                                        <!-- fields {{fields | json}}ss -->

                                                        <div class="filefieldscls"
                                                            *ngFor="let val of fields.imagefields;let ind=index;trackBy: trackByFnMultiple ">

                                                            <br>

                                                            <div *ngIf="val.type == 'text'" class="filefields">

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields == null">
                                                                    <!-- <span>if imgfields ==</span> -->
                                                                    <mat-form-field class="example-full-width">
                                                                        <input matInput type="text"
                                                                            (keyup)="keyupVal(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name,$event)"
                                                                            name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                            matInput
                                                                            placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}">
                                                                    </mat-form-field>
                                                                </div>

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields != null && filearray[fields.name][fi].imgfields.length > 0">
                                                                    <!-- <span>if imgfields ++ </span> -->

                                                                    <mat-form-field class="example-full-width">
                                                                        <input matInput type="text"
                                                                            (keyup)="keyupVal(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name,$event)"
                                                                            name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                            value={{filearray[fields.name][fi].imgfields[ind].value}}
                                                                            matInput
                                                                            placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}">
                                                                    </mat-form-field>
                                                                </div>

                                                            </div>

                                                            <!-- [(ngModel)]="filearray[fields.name][fi].imagefields[ind].value" -->

                                                            <div *ngIf="val.type == 'textarea'">

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields == null">
                                                                    <mat-form-field class="example-full-width">
                                                                        <textarea matInput
                                                                            (keyup)="keyupVal(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name,$event)"
                                                                            name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                            matInput
                                                                            placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}"
                                                                            [rows]='3' [cols]='30'></textarea>
                                                                    </mat-form-field>
                                                                </div>

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields != null && filearray[fields.name][fi].imgfields.length > 0">
                                                                    <mat-form-field class="example-full-width">
                                                                        <textarea matInput
                                                                            (keyup)="keyupVal(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name,$event)"
                                                                            name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                            matInput
                                                                            placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}"
                                                                            value={{filearray[fields.name][fi].imgfields[ind].value}}
                                                                            [rows]='3' [cols]='30'></textarea>
                                                                    </mat-form-field>
                                                                </div>


                                                            </div>

                                                            <div *ngIf="val.type == 'number'">

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields == null">
                                                                    <mat-form-field class="example-full-width">
                                                                        <input type="number" matInput
                                                                            (keyup)="keyupVal(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name,$event)"
                                                                            name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                            matInput
                                                                            placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}">
                                                                    </mat-form-field>
                                                                </div>

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields != null && filearray[fields.name][fi].imgfields.length > 0">
                                                                    <mat-form-field class="example-full-width">
                                                                        <input type="number" matInput
                                                                            (keyup)="keyupVal(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name,$event)"
                                                                            name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                            matInput
                                                                            placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}"
                                                                            value={{filearray[fields.name][fi].imgfields[ind].value}}>
                                                                    </mat-form-field>
                                                                </div>

                                                            </div>



                                                            <div *ngIf="val.type == 'checkbox'">

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields == null">
                                                                    <mat-checkbox
                                                                        name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                        matInput
                                                                        placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}"
                                                                        matInput
                                                                        (change)="checkValue(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name)">
                                                                    </mat-checkbox> &nbsp; {{val.label}}
                                                                </div>

                                                                <div
                                                                    *ngIf="filearray[fields.name][fi].imgfields != null && filearray[fields.name][fi].imgfields.length > 0">
                                                                    <!-- chk = >{{filearray[fields.name][fi].imgfields[ind].value}} -->
                                                                    <mat-checkbox
                                                                        name="{{filearray[fields.name][fi].imagefields[ind].name}}"
                                                                        matInput
                                                                        placeholder="{{filearray[fields.name][fi].imagefields[ind].label}}"
                                                                        matInput
                                                                        (change)="checkValue(filearray[fields.name],fields.imagefields,fi,ind,filearray[fields.name][fi].imagefields[ind],fields.name,filearray[fields.name][fi].imagefields[ind].name)"
                                                                        [checked]="filearray[fields.name][fi].imgfields[ind].value">
                                                                    </mat-checkbox> &nbsp; {{val.label}}
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <!-- </div> -->
                                                    </ng-container>
                                                </div>



                                                <div class="actionbtndiv">

                                                    <mat-chip class="fileuploadbutton" *ngIf="files.uploaded==null "
                                                        style="cursor: pointer;" mat-raised-button
                                                        (click)="uploadfilemultiple(fields,files,fi)">
                                                        Upload
                                                    </mat-chip>

                                                    <mat-chip class="deletesinglefilecls" style="cursor: pointer;"
                                                        *ngIf="files.loaded != null && files.loaded==0"
                                                        mat-raised-button
                                                        (click)="deletesinglefilefrommultiple(fields,files,fi)">
                                                        Delete
                                                    </mat-chip>

                                                    <mat-chip class="filedeletebutton" *ngIf="files.uploaded==1"
                                                        style="cursor: pointer;" mat-raised-button
                                                        (click)="deletefilemultiple(fields,files,fi)">
                                                        Delete </mat-chip>
                                                </div>

                                                <section *ngIf="files.uploaded==2 " class="example-section">
                                                    <mat-progress-bar class="example-margin" [color]="color"
                                                        [mode]="mode" [value]="value" [bufferValue]="bufferValue">
                                                    </mat-progress-bar>
                                                </section>
                                            </div>
                                        </div>
                                        <br />
                                    </ng-container>
                                    <div class="actionbtndiv2">
                                        <mat-chip class="uploadallfile"
                                            *ngIf="(filecount[fields.name] !=null && filecount[fields.name] !=filearray[fields.name].length ) || filecount[fields.name]==null"
                                            mat-raised-button (click)="uploadall(fields)">Upload All</mat-chip>
                                        <mat-chip class="deleteallfile" mat-raised-button
                                            (click)="deletefilemultipleall(fields)">
                                            Delete All
                                        </mat-chip>
                                    </div>

                                </ng-container>



                            </div>
                        </div>

                        <mat-error
                            *ngIf="!formGroup.controls[fields.name].valid && formGroup.controls[fields.name].touched">
                            <ng-container *ngFor="let valdidations of fields.validations">
                                <span
                                    *ngIf="formGroup.controls[fields.name].errors!=null && formGroup.controls[fields.name].errors[valdidations.rule.toLowerCase()]">{{valdidations.message}}</span>
                            </ng-container>
                        </mat-error>
                    </div>


                    <section *ngIf="fieldloading == fields.name " class="example-section">
                        <mat-progress-bar class="example-margin" [color]="color" [mode]="mode" [value]="value"
                            [bufferValue]="bufferValue">
                        </mat-progress-bar>
                    </section>
                </div>

            </ng-container>
        </ng-container>



        <!-- <div class="aligner">
            <div id="drop">Drop files here.</div>
            <div id="list">
              <h1>Uploaded Files:</h1>
            </div>
          </div> -->

        <!-- <label for="singleFile">Upload file</label>
<input id="singleFile" type="file" [fileUploadInputFor]= "fileUploadQueue"/>
<br>

<mat-file-upload-queue #fileUploadQueue
    [fileAlias]="'file'"
    [httpUrl]="'https://tge24bc2ne.execute-api.us-east-1.amazonaws.com/dev'">

    <mat-file-upload [file]="file" [id]="i" *ngFor="let file of fileUploadQueue.files; let i = index"></mat-file-upload>
</mat-file-upload-queue> -->


        <!--<mat-form-field class="form-element">
      <input matInput placeholder="Emailaddress" formControlName="email">
      <mat-error *ngIf="!formGroup.controls['email'].valid && formGroup.controls['email'].touched">
        {{ getErrorEmail() }}
      </mat-error>
    </mat-form-field>

    <mat-form-field class="form-element">
      <input matInput placeholder="Name" formControlName="name">
      <mat-error *ngIf="!name.valid && name.touched">
        {{ titleAlert }}
      </mat-error>
    </mat-form-field>

    <mat-form-field class="form-element">
      <textarea matInput placeholder="Description" matTextareaAutosize matAutosizeMinRows="2" matAutosizeMaxRows="5" formControlName="description"></textarea>
      <mat-error *ngIf="!formGroup.controls['description'].valid && formGroup.controls['description'].touched">
        Required field, must be between 5 and 10 characters.
      </mat-error>
    </mat-form-field>

    <mat-form-field class="form-element">
      <input matInput placeholder="Password" formControlName="password">
      <mat-hint>Choose a password of at least eight characters, one uppercase letter and one number</mat-hint>
      <mat-error *ngIf="!formGroup.controls['password'].valid && formGroup.controls['password'].touched">
        {{ getErrorPassword() }}
      </mat-error>
    </mat-form-field>

    <div class="form-element">
      <mat-checkbox formControlName="validate" value="1">Name min. 3 characters</mat-checkbox>
    </div>-->

        <div class="form-element">
            <button mat-raised-button color="primary" type="submit" class="button"
                [disabled]="!formdataval.submitactive">{{formdataval.submittext}}</button>
            <button mat-raised-button color="primary" *ngIf="!formdataval.hidecancel" type="button" class="button"
                (click)="navtocancel()">{{formdataval.canceltext}}</button>
            <button mat-raised-button color="primary" *ngIf="!formdataval.hidereset" type="reset"
                (click)="resetformdata()" class="button">{{formdataval.resettext}}</button>

            <div class="custombuttonscls"
                *ngIf="formdataval.custombuttons != null && formdataval?.custombuttons.length > 0">
                <div *ngFor="let val of formdataval?.custombuttons">
                    <button mat-raised-button color="primary" *ngIf="val?.name !=null && val?.name !=''" type="button"
                        (click)="getFormVal(val)" class="button" matTooltip="{{val?.tooltip}}">{{val?.label}}</button>
                </div>
            </div>
        </div>


    </form>
</div>

<ng-template #forminfo>
    <div class="container">
        {{ post | json }}
    </div>
</ng-template>